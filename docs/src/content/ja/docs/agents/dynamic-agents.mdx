---
title: "動的エージェント"
description: 実行時のコンテキストを使用して、エージェントの指示、モデル、ツールを動的に設定します。
---

# 動的エージェント

動的エージェントは、ユーザーIDやその他の重要なパラメータなどの[ランタイムコンテキスト](./runtime-variables)を使用して、リアルタイムで設定を調整します。

これにより、使用するモデルの変更、指示の更新、必要に応じて異なるツールの選択が可能になります。

このコンテキストを活用することで、エージェントは各ユーザーのニーズにより適切に対応できます。また、より多くの情報を収集するために任意のAPIを呼び出すことができ、エージェントの機能を向上させるのに役立ちます。

### 設定例

以下は、ユーザーのサブスクリプション層と言語設定に基づいて動作を調整する動的サポートエージェントの例です：

```typescript
const supportAgent = new Agent({
  name: "Dynamic Support Agent",
  
  instructions: async ({ runtimeContext }) => {
    const userTier = runtimeContext.get("user-tier");
    const language = runtimeContext.get("language");
    
    return `You are a customer support agent for our SaaS platform.
    The current user is on the ${userTier} tier and prefers ${language} language.
    
    For ${userTier} tier users:
    ${userTier === "free" ? "- Provide basic support and documentation links" : ""}
    ${userTier === "pro" ? "- Offer detailed technical support and best practices" : ""}
    ${userTier === "enterprise" ? "- Provide priority support with custom solutions" : ""}
    
    Always respond in ${language} language.`;
  },

  model: ({ runtimeContext }) => {
    const userTier = runtimeContext.get("user-tier");
    return userTier === "enterprise" 
      ? openai("gpt-4") 
      : openai("gpt-3.5-turbo");
  },

  tools: ({ runtimeContext }) => {
    const userTier = runtimeContext.get("user-tier");
    const baseTools = [knowledgeBase, ticketSystem];
    
    if (userTier === "pro" || userTier === "enterprise") {
      baseTools.push(advancedAnalytics);
    }
    
    if (userTier === "enterprise") {
      baseTools.push(customIntegration);
    }
    
    return baseTools;
  },
});
```

この例では、エージェントは：
- ユーザーのサブスクリプション層（無料、プロ、エンタープライズ）に基づいて指示を調整します
- エンタープライズユーザーにはより強力なモデル（GPT-4）を使用します
- ユーザーの層に基づいて異なるツールセットを提供します
- ユーザーの好みの言語で応答します

これは、単一のエージェントがランタイムコンテキストを活用して異なるタイプのユーザーやシナリオを処理する方法を示しており、各ユースケースに対して別々のエージェントを作成するよりも柔軟で保守しやすくなっています。

APIルート、ミドルウェアのセットアップ、ランタイムコンテキストの処理を含む完全な実装例については、[動的エージェントの例](/examples/agents/dynamic-agents)をご覧ください。
