---
title: "リファレンス: createGraphRAGTool() | RAG | Mastra Tools ドキュメント"
description: Mastra の Graph RAG Tool のドキュメント。これは、ドキュメント間のセマンティックな関係のグラフを構築することで RAG を強化します。
---

# createGraphRAGTool()

`createGraphRAGTool()` は、ドキュメント間のセマンティックな関係のグラフを構築することでRAGを強化するツールを作成します。内部的には `GraphRAG` システムを利用してグラフベースの検索を提供し、直接的な類似性だけでなく、関連する接続関係を通じて適切なコンテンツを見つけ出します。

## 使用例

```typescript
import { openai } from "@ai-sdk/openai";
import { createGraphRAGTool } from "@mastra/rag";

const graphTool = createGraphRAGTool({
  vectorStoreName: "pinecone",
  indexName: "docs",
  model: openai.embedding("text-embedding-3-small"),
  graphOptions: {
    dimension: 1536,
    threshold: 0.7,
    randomWalkSteps: 100,
    restartProb: 0.15,
  },
});
```

## パラメータ

<PropertiesTable
  content={[
    {
      name: "vectorStoreName",
      type: "string",
      description: "クエリするベクトルストアの名前",
      isOptional: false,
    },
    {
      name: "indexName",
      type: "string",
      description: "ベクトルストア内のインデックスの名前",
      isOptional: false,
    },
    {
      name: "model",
      type: "EmbeddingModel",
      description: "ベクトル検索に使用する埋め込みモデル",
      isOptional: false,
    },
    {
      name: "enableFilter",
      type: "boolean",
      description: "メタデータに基づく結果のフィルタリングを有効にする",
      isOptional: true,
      defaultValue: "false",
    },
    {
      name: "includeSources",
      type: "boolean",
      description: "結果に完全な取得オブジェクトを含める",
      isOptional: true,
      defaultValue: "true",
    },
    {
      name: "graphOptions",
      type: "GraphOptions",
      description: "グラフベースの検索のための設定",
      isOptional: true,
      defaultValue: "デフォルトのグラフオプション",
    },
    {
      name: "description",
      type: "string",
      description:
        "ツールのカスタム説明。デフォルトでは：'ナレッジベース内の情報間の関係にアクセスして分析し、接続やパターンに関する複雑な質問に答える'",
      isOptional: true,
    },
  ]}
/>

### GraphOptions

<PropertiesTable
  content={[
    {
      name: "dimension",
      type: "number",
      description: "埋め込みベクトルの次元",
      isOptional: true,
      defaultValue: "1536",
    },
    {
      name: "threshold",
      type: "number",
      description:
        "ノード間のエッジを作成するための類似度しきい値（0-1）",
      isOptional: true,
      defaultValue: "0.7",
    },
    {
      name: "randomWalkSteps",
      type: "number",
      description: "グラフ走査のためのランダムウォークのステップ数",
      isOptional: true,
      defaultValue: "100",
    },
    {
      name: "restartProb",
      type: "number",
      description: "クエリノードからランダムウォークを再開する確率",
      isOptional: true,
      defaultValue: "0.15",
    },
  ]}
/>

## 戻り値

このツールは以下を含むオブジェクトを返します：

<PropertiesTable
  content={[
    {
      name: "relevantContext",
      type: "string",
      description:
        "グラフベースのランキングを使用して取得された、最も関連性の高いドキュメントチャンクからの結合テキスト",
    },
    {
      name: "sources",
      type: "QueryResult[]",
      description: "完全な検索結果オブジェクトの配列。各オブジェクトには、元のドキュメント、チャンク、および類似度スコアを参照するために必要なすべての情報が含まれています。",
    },
  ]}
/>

### QueryResultオブジェクトの構造

```typescript
{
  id: string;         // ユニークなチャンク/ドキュメント識別子
  metadata: any;      // すべてのメタデータフィールド（ドキュメントIDなど）
  vector: number[];   // 埋め込みベクトル（利用可能な場合）
  score: number;      // この検索の類似度スコア
  document: string;   // 完全なチャンク/ドキュメントテキスト（利用可能な場合）
}
```

## デフォルトツールの説明

デフォルトの説明は以下に重点を置いています：

- ドキュメント間の関係性の分析
- パターンやつながりの発見
- 複雑なクエリへの回答

## 応用例

```typescript
const graphTool = createGraphRAGTool({
  vectorStoreName: "pinecone",
  indexName: "docs",
  model: openai.embedding("text-embedding-3-small"),
  graphOptions: {
    dimension: 1536,
    threshold: 0.8, // Higher similarity threshold
    randomWalkSteps: 200, // More exploration steps
    restartProb: 0.2, // Higher restart probability
  },
});
```

## カスタム説明付きの例

```typescript
const graphTool = createGraphRAGTool({
  vectorStoreName: "pinecone",
  indexName: "docs",
  model: openai.embedding("text-embedding-3-small"),
  description:
    "Analyze document relationships to find complex patterns and connections in our company's historical data",
});
```

この例では、関係性分析という基本的な目的を維持しつつ、特定のユースケースに合わせてツールの説明をカスタマイズする方法を示しています。

## 関連

- [createVectorQueryTool](./vector-query-tool)
- [GraphRAG](../rag/graph-rag)
